'use client';
import { useCallback } from 'react';
import { flushSync } from 'react-dom';
import { useLatestRef } from './use-latest-ref.mjs';

function useEvent(callback, opts = {}) {
  const { sync = false } = opts;
  const callbackRef = useLatestRef(callback);
  return useCallback(
    (...args) => {
      if (sync)
        return flushSync(() => callbackRef.current?.(...args));
      return callbackRef.current?.(...args);
    },
    [sync, callbackRef]
  );
}

export { useEvent };
